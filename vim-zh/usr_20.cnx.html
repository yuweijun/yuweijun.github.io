<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>~/github.com/yuweijun/yuweijun.github.io/vim-zh/usr_20.cnx.html</title>
<meta name="Generator" content="Vim/8.2">
<meta name="plugin-version" content="vim8.1_v2">
<meta name="syntax" content="help">
<meta name="settings" content="use_css,pre_wrap,no_foldcolumn,prevent_copy=,use_input_for_pc=fallback">
<meta name="colorscheme" content="molokai">
<style>
<!--
pre { white-space: pre-wrap; font-family: monospace; color: #d0d0d0; background-color: #121212; }
body { font-family: monospace; color: #d0d0d0; background-color: #121212; }
* { font-size: 1em; }
.String { color: #afaf87; }
.Type { color: #5fd7ff; }
.PreProc { color: #87ff00; }
.Identifier { color: #ff8700; }
.Comment { color: #5f5f5f; }
.Special { color: #5fd7ff; }
.Ignore { color: #808080; background-color: #080808; padding-bottom: 1px; }
-->
</style>
</head>
<body>
<pre id='vimCodeElement'>
<span class="Ignore">*</span><span class="String">usr_20.txt</span><span class="Ignore">*</span>	For <span class="Identifier">Vim version 8.0.</span>  最近更新: 2005年3月

		     VIM 用户手册 - by Bram Moolenaar
		     译者: Chimin Yen <span class="String"><a href="http://vimcdoc.sf.net">http://vimcdoc.sf.net</a></span>

			     快速键入命令行命令

Vim 具备若干基本功能，以简化键入命令的工作。你可以缩写，编辑和重复冒号命令，而
补全功能几乎可以用于所有的场合。

<span class="Ignore">|</span><span class="Identifier">20.1</span><span class="Ignore">|</span>	命令行编辑
<span class="Ignore">|</span><span class="Identifier">20.2</span><span class="Ignore">|</span>	命令行缩写
<span class="Ignore">|</span><span class="Identifier">20.3</span><span class="Ignore">|</span>	命令行补全
<span class="Ignore">|</span><span class="Identifier">20.4</span><span class="Ignore">|</span>	命令行历史
<span class="Ignore">|</span><span class="Identifier">20.5</span><span class="Ignore">|</span>	命令行窗口

     下一章: <span class="Ignore">|</span><span class="Identifier">usr_21.txt</span><span class="Ignore">|</span>  离开和回来
     前一章: <span class="Ignore">|</span><span class="Identifier">usr_12.txt</span><span class="Ignore">|</span>  小窍门
       目录: <span class="Ignore">|</span><span class="Identifier">usr_toc.txt</span><span class="Ignore">|</span>

<span class="PreProc">==============================================================================</span>
<span class="Ignore">*</span><span class="String">20.1</span><span class="Ignore">*</span>	命令行编辑

当你用冒号 (:) 命令或用 / 或 ? 搜索一个字符串时，Vim 就会把光标置于屏幕下方。
你在那儿键入命令或者搜索模式。此处即称为命令行，也是用来输入搜索命令的地方。

最为显而易见的编辑命令的方法是按 <span class="Special">&lt;BS&gt;</span> 退格键。按下此键即删去光标前面的字符。如
果要删去另一个更早键入的字符，得先用光标方向键把光标移到那儿。

   例如，你键入了:<span class="Ignore"> &gt;</span>

<span class="Comment">	:s/col/pig/</span>

在你按下回车键之前，你注意到 &quot;col&quot; 应为 &quot;cow&quot;。为了纠正这个错误，你按五次
<span class="Special">&lt;Left&gt;</span> 键。现在，光标正好在 &quot;col&quot; 后面。按 <span class="Special">&lt;BS&gt;</span> 键，然后键入正确的字符 &quot;w&quot;:<span class="Ignore"> &gt;</span>

<span class="Comment">	:s/cow/pig/</span>

现在你可以立刻按 <span class="Special">&lt;Enter&gt;</span> 键了。在执行这个命令之前，你无须先把光标移到命令行的
末尾。

命令行上移动光标时最常用的键:

	<span class="Special">&lt;Left&gt;</span>			左移一个字符
	<span class="Special">&lt;Right&gt;</span>			右移一个字符
	<span class="Special">&lt;S-Left&gt;</span> 或 <span class="Special">&lt;C-Left&gt;</span>	左移一个单词
	<span class="Special">&lt;S-Right&gt;</span> 或 <span class="Special">&lt;C-Right&gt;</span>	右移一个单词
	<span class="Special">CTRL-B</span> 或 <span class="Special">&lt;Home&gt;</span>	命令行行首
	<span class="Special">CTRL-E</span> 或 <span class="Special">&lt;End&gt;</span>		命令行行尾

	备注:
	<span class="Special">&lt;S-Left&gt;</span> (光标左移键和 Shift 键同时按下) 和 <span class="Special">&lt;C-Left&gt;</span> (光标左移键和
	Control 键同时按下) 并非在所有键盘上都有效。其它 Shift 和 Control 组合
	键也是这种情况。

你也可以用鼠标来移动光标。


删 除

如前所述，<span class="Special">&lt;BS&gt;</span> 键删除光标前一个字符。删除光标前整个单词，则用 <span class="Special">CTRL-W</span>。

	<span class="PreProc">/the fine pig</span><span class="Ignore"> ~</span>

		     <span class="Special">CTRL-W</span>

	<span class="PreProc">/the fine</span><span class="Ignore"> ~</span>

<span class="Special">CTRL-U</span> 删除命令行上全部文字，从而让你从头开始。


替 换

插入键 <span class="Special">&lt;Insert&gt;</span> 让你在插入字符和替换字符两种方式之间切换。先键入如下文字:

	<span class="PreProc">/the fine pig</span><span class="Ignore"> ~</span>

再按两次 <span class="Special">&lt;S-Left&gt;</span> (或 <span class="Special">&lt;S-Left&gt;</span> 无效时按八次 <span class="Special">&lt;Left&gt;</span>)，把光标移到 &quot;fine&quot; 起始
处。现在，按插入键 <span class="Special">&lt;Insert&gt;</span>，切换到替换方式，并键入 &quot;great&quot;:

	<span class="PreProc">/the greatpig</span><span class="Ignore"> ~</span>

哟，空格没了。现在，别用 <span class="Special">&lt;BS&gt;</span> 键，因为那会删除 &quot;t&quot; (这跟插入方式不同)。此时应
该按插入键 <span class="Special">&lt;Insert&gt;</span>，从替换方式切换到插入方式，并键入空格:

	<span class="PreProc">/the great pig</span><span class="Ignore"> ~</span>


取 消

你本想执行一个 : 或 / 命令，但却改变了主意。要清除命令行上你已经键入的文字却不
执行该命令，按 <span class="Special">CTRL-C</span> 或 <span class="Special">&lt;Esc&gt;</span>。

	备注:
	<span class="Special">&lt;Esc&gt;</span> 是普遍采用的 &quot;退出&quot; 键。不幸的是，在过去美好的 Vi 版本里，在命令
	行上按 <span class="Special">&lt;Esc&gt;</span> 却是执行命令！由于那会被认为是程序 bug，Vim 采用 <span class="Special">&lt;Esc&gt;</span> 来
	取消命令。但其 <span class="Type">'cpoptions'</span> 选项可以使 Vim 跟 Vi 兼容。而且，使用映射时
	(那可能是为 Vi 而写的)，<span class="Special">&lt;Esc&gt;</span> 键也总和 Vi 兼容。由此看来，采用 <span class="Special">CTRL-C</span>
	倒不失为一种永远奏效的方法。

如果你在命令行开始处，那么按 <span class="Special">&lt;BS&gt;</span> 将取消整个命令。这就像删除命令行赖以开始的
&quot;:&quot; 或 &quot;/&quot;。

<span class="PreProc">==============================================================================</span>
<span class="Ignore">*</span><span class="String">20.2</span><span class="Ignore">*</span>	命令行缩写

有些 &quot;:&quot; 命令确实很长。我们已经提及替代命令 &quot;:substitute&quot; 可以被缩写成 &quot;:s&quot;。
这是一个基本机理，即所有 &quot;:&quot; 冒号命令都可以被缩写。

一个命令可以被缩写成多短呢？英文有 26 个字母，而 Vim 却有多得多的命令。例如，
&quot;:set&quot; 也以 &quot;:s&quot; 开头，但 &quot;:s&quot; 不是启动 &quot;:set&quot; 命令的。&quot;:set&quot; 可以被缩写成
&quot;:se&quot;。
   把一个命令缩写得更短即可能适用于两个命令，此时，该缩写仍然只能代表其中的一
个。而选择哪个却没有任何逻辑，你不得不一个一个地记。最短的有效缩写形式可以在帮
助文件里找到。例如:
<span class="Ignore">&gt;</span>
<span class="Comment">	:s[ubstitute]</span>

它的意思是替代命令 &quot;:substitute&quot; 的最短缩写形式是 &quot;:s&quot;。随后的字符可以任选。因
此 &quot;:su&quot; 和 &quot;:sub&quot; 都有效。

在用户手册里我们有时用命令的全称，有时简称意义明白就用简称。例如，&quot;:function&quot;
可以缩写成 &quot;:fu&quot;。但既然大多数读者不明其所指，所以我们采用简称 &quot;:fun&quot;。(Vim 没
有命令 &quot;:funny&quot;，否则简称 &quot;:fun&quot; 也会令人迷惑。)

在 Vim 脚本里你最好用命令全称。当你日后改编脚本时，全称读起来比较容易。除非那
是一些常用命令如 &quot;:w&quot; (&quot;:write&quot;) 和 &quot;:r&quot; (&quot;:read&quot;)。
   一个特别令人迷惑的缩写是 &quot;:end&quot;，它可以指 &quot;:endif&quot;，&quot;:endwhile&quot; 或
&quot;:endfunction&quot;。所以，遇到这类命令时，最好永远采用全称。


选 项 简 称

在用户手册里，我们采用选项的全称。许多选项还有简称。跟 &quot;:&quot; 冒号命令不一样，有
效的选项简称只有一个。例如，<span class="Type">'autoindent'</span> 的简称是 <span class="Type">'ai'</span>。因而下面两个命令完成同
样的动作:<span class="Ignore"> &gt;</span>

<span class="Comment">	:set autoindent</span>
<span class="Comment">	:set ai</span>

你可以从这儿找到完整的选项全称和简称的列表: <span class="Ignore">|</span><span class="Identifier">option-list</span><span class="Ignore">|</span>。

<span class="PreProc">==============================================================================</span>
<span class="Ignore">*</span><span class="String">20.3</span><span class="Ignore">*</span>	命令行补全

命令行补全是那些仅仅因为它就值得从 Vi 转到 Vim 的功能之一。一旦你用上了这个功
能，你就离不开它了。

假定你有个文件目录，其中存放了这些文件:

	info.txt
	intro.txt
	bodyofthepaper.txt

你用这个命令来编辑最后那个文件:<span class="Ignore"> &gt;</span>

<span class="Comment">	:edit bodyofthepaper.txt</span>

这很容易打错。一个快得多的方法是:<span class="Ignore"> &gt;</span>

<span class="Comment">	:edit b&lt;Tab&gt;</span>

其结果是同样的命令。这是怎么回事？制表键 <span class="Special">&lt;Tab&gt;</span> 会补全光标前的词。在本例中就是
&quot;b&quot;。Vim 在目录中寻找并找到了唯一的一个以 &quot;b&quot; 开头的文件。那个文件想必是你寻找
的，因此 Vim 为你补全了文件名。

现在键入:<span class="Ignore"> &gt;</span>

<span class="Comment">	:edit i&lt;Tab&gt;</span>

Vim 会鸣起响铃，并给你这个结果:<span class="Ignore"> &gt;</span>

<span class="Comment">	:edit info.txt</span>

响铃的意思是 Vim 找到了不止一个匹配。然后它使用了找到的第一个匹配 (按字母顺
序)。如果你再按一次 <span class="Special">&lt;Tab&gt;</span>，你得到:<span class="Ignore"> &gt;</span>

<span class="Comment">	:edit intro.txt</span>

这样，如果第一次 <span class="Special">&lt;Tab&gt;</span> 没给你你要找的文件，你就再按一次。如果还有匹配的文件，
你将会看到它们每一个，每按一次，就看到一个。
   如果你在最后一个匹配文件名上按 <span class="Special">&lt;Tab&gt;</span>，你将会再次看到你起初键入的那个命令:<span class="Ignore"> &gt;</span>

<span class="Comment">	:edit i</span>

然后一切再从头开始。这样，Vim 就在匹配列表内周而复始地循环。使用 <span class="Special">CTRL-P</span> 依相反
方向循环匹配列表:

	      &lt;------------------- <span class="Special">&lt;Tab&gt;</span> -------------------------+
								  |
		  <span class="Special">&lt;Tab&gt;</span> --&gt;		       <span class="Special">&lt;Tab&gt;</span> --&gt;
	:edit i		      :edit info.txt		   :edit intro.txt
		  &lt;-- <span class="Special">CTRL-P</span>		       &lt;-- <span class="Special">CTRL-P</span>
	   |
	   +---------------------- <span class="Special">CTRL-P</span> ------------------------&gt;


上 下 文

当你键入 &quot;:set i&quot; 而不是 &quot;:edit i&quot;，并按 <span class="Special">&lt;Tab&gt;</span>，你得到的是:<span class="Ignore"> &gt;</span>

<span class="Comment">	:set icon</span>

嗨，为什么你没得到 &quot;:set info.txt&quot;？这是由于 Vim 的补全功能是上下文相关的。
Vim 寻找的那类词取决于关键词前面的命令。Vim 知道你不可能在命令 &quot;:set&quot; 后面用一
个文件名，但却可以用一个选项名。
   同样，如果你重复键入 <span class="Special">&lt;Tab&gt;</span>，Vim 就会在所有匹配间周而复始地循环。你最好开始
时多键入几个字符，否则匹配的选项会很多:<span class="Ignore"> &gt;</span>

<span class="Comment">	:set isk&lt;Tab&gt;</span>

结果是:<span class="Ignore"> &gt;</span>

<span class="Comment">	:set iskeyword</span>

现在键入 &quot;=&quot; 并按 <span class="Special">&lt;Tab&gt;</span>:<span class="Ignore"> &gt;</span>

<span class="Comment">	:set iskeyword=@,48-57,_,192-255</span>

在此，Vim 插入的是该选项原来的设定值。现在你可以编辑它了。
   按 <span class="Special">&lt;Tab&gt;</span> 键补全的乃是 Vim 在命令行那个位置上所期待的。你不妨试试，看它究竟
是如何补全的。在某些情形下你会得不到你想要的结果。那或者因为 Vim 不知道你要什
么，或者因为 Vim 还没有为该情况实现补全功能。在那个场合，你的 <span class="Special">&lt;Tab&gt;</span> 就会被当作
字符插入文本 (显示为 ^I)。


匹 配 列 表

当匹配有很多时，你可能希望看到一个总览。要看匹配总览，请按 <span class="Special">CTRL-D</span>。例如，你键
入了以下命令以后按 <span class="Special">CTRL-D</span>:<span class="Ignore"> &gt;</span>

<span class="Comment">	:set is</span>

结果是:<span class="Ignore"> &gt;</span>

<span class="Comment">	:set is</span>
<span class="Comment">	incsearch  isfname    isident    iskeyword  isprint</span>
<span class="Comment">	:set is</span>

Vim 列出了匹配，然后又伴随着你早先键入的命令回到命令行。你现在可以检验匹配列
表，找你想要的选项了。如果它不在列表中，你可以用 <span class="Special">&lt;BS&gt;</span> 修正那个词。如果匹配太
多了，就在按 <span class="Special">&lt;Tab&gt;</span> 键补全命令之前再多打几个字符。
   如果你仔细观察了，你就会注意到选项 &quot;incsearch&quot; 不是以 &quot;is&quot; 开头。在这个场
合，&quot;is&quot; 指的就是 &quot;incsearch&quot; 的简称。(许多选项都有其简称和全称。) Vim 知道你
可能要把选项的简称扩展成全称，够聪明的吧。


更 多 选 项

命令 <span class="Special">CTRL-L</span> 把词补全为最长无歧义字符串。如果你键入 &quot;:edit i&quot; 而目录内存放着文
件 &quot;info.txt&quot; 和 &quot;info_backup.txt&quot;，那么，你将得到 &quot;:edit info&quot;。

选项 <span class="Type">'wildmode'</span> 可用来改变补全时采用的方式。
选项 <span class="Type">'wildmenu'</span> 可用来取得菜单式的匹配列表。
利用选项 <span class="Type">'suffixes'</span> 来指定一些不太重要的文件，并让它们出现在文件列表末尾。
选项 <span class="Type">'wildignore'</span> 指定一些根本用不着表列的文件。

欲知更多此类选项详情，参见: <span class="Ignore">|</span><span class="Identifier">cmdline-completion</span><span class="Ignore">|</span>

<span class="PreProc">==============================================================================</span>
<span class="Ignore">*</span><span class="String">20.4</span><span class="Ignore">*</span>	命令行历史

我们曾经在第三章简单提到过历史记录功能。其基本用法就是你可以用 <span class="Special">&lt;Up&gt;</span> 键调用较
早的命令行。而 <span class="Special">&lt;Down&gt;</span> 键则让你回到较晚的命令行。

历史记录功能实际上共有四种。我们在这里要提到的是用于 &quot;:&quot; 冒号命令以及用于 &quot;/&quot;
和 &quot;?&quot; 搜索命令的历史记录功能。&quot;/&quot; 和 &quot;?&quot; 命令共享同一历史记录。因为两者同为搜
索命令。另外两种历史记录功能用于函数 input() 的表达式和输入行。
<span class="Ignore">|</span><span class="Identifier">cmdline-history</span><span class="Ignore">|</span>

假定你完成了一个 &quot;:set&quot; 命令，又键入了十个冒号命令，然后要再次执行那个 &quot;:set&quot;
命令。你本可以按一个 &quot;:&quot;，然后按十次 <span class="Special">&lt;Up&gt;</span>。更快捷的方法是:<span class="Ignore"> &gt;</span>

<span class="Comment">	:se&lt;Up&gt;</span>

你现在就回到以前执行过的，以 &quot;se&quot; 开头的命令。没准儿那就是你想找的 &quot;:set&quot; 命
令。至少你不至于按很多 <span class="Special">&lt;Up&gt;</span> 键 (除非你执行的都是 &quot;:set&quot; 命令)。

<span class="Special">&lt;Up&gt;</span> 键用你在命令行上已经键入的文本去跟历史记录里的命令作比较。只有匹配的命令
才被显示出来。
   如果你没找到你要找的命令，用 <span class="Special">&lt;Down&gt;</span> 回到你键入的文本作修改。或者用 <span class="Special">CTRL-U</span>
从头来过。

显示历史记录里所有的命令:<span class="Ignore"> &gt;</span>

<span class="Comment">	:history</span>

那是 &quot;:&quot; 冒号命令的历史记录。搜索历史记录用这个命令来显示:<span class="Ignore"> &gt;</span>

<span class="Comment">	:history /</span>

如果你不愿用光标方向键，<span class="Special">CTRL-P</span> 作用就跟 <span class="Special">&lt;Up&gt;</span> 一样。而 <span class="Special">CTRL-N</span> 跟 <span class="Special">&lt;Down&gt;</span> 一样。
<span class="Special">CTRL-P</span> 意指前一个 (previous)，<span class="Special">CTRL-N</span> 意指下一个 (next)。

<span class="PreProc">==============================================================================</span>
<span class="Ignore">*</span><span class="String">20.5</span><span class="Ignore">*</span>	命令行窗口

在命令行上键入文本跟插入模式下键入文本有所不同。许多修改文本的命令都不能用。对
大多数命令而言，那问题不大，但有时你必须键入一个复杂的命令。那样的场合用命令行
窗口就非常有用了。

用这个命令来打开命令行窗口:<span class="Ignore"> &gt;</span>

<span class="Comment">	q:</span>

Vim 现在就在屏幕底部打开了一个 (很小的) 窗口。它存放着命令行历史记录，以及一行
空行在末尾:

	+-------------------------------------+
	|other window			      |
	|~				      |
	|file.txt=============================|
	|:e c				      |
	|:e config.h.in			      |
	|:set path=.,/usr/include,,	      |
	|:set iskeyword=@,48-57,_,192-255     |
	|:set is			      |
	|:q				      |
	|:				      |
	|command-line=========================|
	|				      |
	+-------------------------------------+

现在你处于普通模式下。你可以用 &quot;hjkl&quot; 键来移动光标。例如，用 &quot;5k&quot; 上移至
&quot;:e config.h.in&quot; 那一行。键入 &quot;$h&quot; 移到 &quot;in&quot; 的 &quot;i&quot; 字符上，并键入 &quot;cwout&quot;。
现在你把这一行改成了这样:

	<span class="PreProc">:e config.h.out</span><span class="Ignore"> ~</span>

现在按 <span class="Special">&lt;Enter&gt;</span> 执行这个命令。命令行窗口就关上了。
按 <span class="Special">&lt;Enter&gt;</span> 键执行光标下的那个命令。这跟 Vim 处于插入模式抑或普通模式无关。
   在命令行窗口内所作的修改不会被保存。它们不会导致历史记录被修改。唯一例外就
是你执行的命令将被加到历史记录的末尾，跟所有执行过的命令一样。

在你要总览历史记录时，命令行窗口十分有用，查找类似命令，修改一点点，然后执行
它。一个搜索命令可用来寻找某些东西。
   在前面那个例子中，搜索命令 &quot;?config&quot; 是可以用来寻找先前那个含有 &quot;config&quot; 的
命令的。这有点儿特别，因为你是在命令行窗口内用命令行作搜索。在键入搜索命令时，
你打不开另一个命令行窗口，命令行窗口是唯一的。

<span class="PreProc">==============================================================================</span>

下一章: <span class="Ignore">|</span><span class="Identifier">usr_21.txt</span><span class="Ignore">|</span>  离开和返回

版权: 参见 <span class="Ignore">|</span><span class="Identifier">manual-copyright</span><span class="Ignore">|</span>  vim&#0058;tw=78:ts=8:ft=help:norl:
</pre>
</body>
</html>
<!-- vim: set foldmethod=manual : -->
